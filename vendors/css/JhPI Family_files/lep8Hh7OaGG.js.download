if (self.CavalryLogger) { CavalryLogger.start_js(["g1Ftu"]); }

__d("MessengerMontageClientTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MessengerMontageClientLoggerConfig",this.$MessengerMontageClientTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MessengerMontageClientLoggerConfig",this.$MessengerMontageClientTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$MessengerMontageClientTypedLogger1={};return this};h.prototype.updateData=function(j){this.$MessengerMontageClientTypedLogger1=babelHelpers["extends"]({},this.$MessengerMontageClientTypedLogger1,j);return this};h.prototype.setContentType=function(j){this.$MessengerMontageClientTypedLogger1.content_type=j;return this};h.prototype.setCurrentPosition=function(j){this.$MessengerMontageClientTypedLogger1.current_position=j;return this};h.prototype.setEntryPoint=function(j){this.$MessengerMontageClientTypedLogger1.entry_point=j;return this};h.prototype.setEvent=function(j){this.$MessengerMontageClientTypedLogger1.event=j;return this};h.prototype.setExitAction=function(j){this.$MessengerMontageClientTypedLogger1.exit_action=j;return this};h.prototype.setMessageDuration=function(j){this.$MessengerMontageClientTypedLogger1.message_duration=j;return this};h.prototype.setMessageSource=function(j){this.$MessengerMontageClientTypedLogger1.message_source=j;return this};h.prototype.setMessageStartTime=function(j){this.$MessengerMontageClientTypedLogger1.message_start_time=j;return this};h.prototype.setMid=function(j){this.$MessengerMontageClientTypedLogger1.mid=j;return this};h.prototype.setOwnerID=function(j){this.$MessengerMontageClientTypedLogger1.owner_id=j;return this};h.prototype.setQueueType=function(j){this.$MessengerMontageClientTypedLogger1.queue_type=j;return this};h.prototype.setTotalQueue=function(j){this.$MessengerMontageClientTypedLogger1.total_queue=j;return this};h.prototype.setVC=function(j){this.$MessengerMontageClientTypedLogger1.vc=j;return this};h.prototype.updateExtraData=function(j){j=c("nullthrows")(c("GeneratedLoggerUtils").serializeMap(j));c("GeneratedLoggerUtils").checkExtraDataFieldNames(j,i);this.$MessengerMontageClientTypedLogger1=babelHelpers["extends"]({},this.$MessengerMontageClientTypedLogger1,j);return this};h.prototype.addToExtraData=function(j,k){var l={};l[j]=k;return this.updateExtraData(l)};var i={content_type:true,current_position:true,entry_point:true,event:true,exit_action:true,message_duration:true,message_source:true,message_start_time:true,mid:true,owner_id:true,queue_type:true,total_queue:true,vc:true};f.exports=h}),null);
__d("MessengerLogo.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h=function h(i){var j=i.color,k=i.size;return c("React").createElement("div",{style:{width:k,height:k}},c("React").createElement("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},c("React").createElement("g",{transform:"scale(0.02)",fill:"none"},c("React").createElement("path",{fill:j,fillRule:"evenodd",d:"M399.494079,0.00274415094 C178.859771,0.00274415094 0.000304955527,167.227237 0.000304955527,373.508113 C0.000304955527,490.856138 57.8859466,595.562774 148.414028,664.036455 L148.414028,806.983343 L284.747446,731.373854 C321.092046,741.545506 359.609962,747.013481 399.494079,747.013481 C620.128386,747.013481 798.987853,579.788988 798.987853,373.508113 C798.987853,167.227237 620.128386,0.00274415094 399.494079,0.00274415094 M441.568386,500.879189L338.245388 393.558495 139.264956 503.581669 357.419975 272.117619 460.742973 379.437297 659.722389 269.414122z"}))))};f.exports=h}),null);
__d("MontageProgressBar.react",["cx","React"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.activeIndex,l=j.count,m=j.progressPercent,n=[];for(var o=0;o<l;o++)n.push(c("React").createElement("div",{key:o,className:"_4wd4"+(o===k?" _4wd6":"")},o===k?c("React").createElement("div",{className:"_4wd4 _4wd7",style:{width:m+"%"}}):null));return c("React").createElement("div",{className:"_4wd8"},n)};f.exports=i}),null);
__d("MontageMessageReactionsWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1428286587248085"};j.getQueryID=function(){"use strict";return"138011586785590"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("MontageReplyAction",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DOODLE:"DOODLE",MESSAGE_REACTION:"MESSAGE_REACTION"})}),null);
__d("MontageReplyComposer.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return null};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("MontageReplyLWRUtil",["EmojiFormat"],(function a(b,c,d,e,f,g){"use strict";var h=[[128525],[128518],[128558],[128546],[128544]];f.exports={defaultReactions:h.map(c("EmojiFormat").codeArrayToUnicode)}}),null);
__d("MontageReplyLWR.react",["cx","Bootloader","DOM","DOMContainer.react","MessengerTextWithEmoticons.react","MontageReplyLWRUtil","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.state={animations:{}},this.$MontageReplyLWR3=function(event){this.$MontageReplyLWR1[event.currentTarget.tabIndex].offsets.push(Date.now()-this.props.startedTime)}.bind(this),m}k.prototype.componentWillMount=function(){this.$MontageReplyLWR2()};k.prototype.componentDidMount=function(){this.loadAnimation()};k.prototype.render=function(){return c("React").createElement("div",{className:"_60yi"},c("MontageReplyLWRUtil").defaultReactions.map(function(l,m){return c("React").createElement("span",{className:"_3bih",key:l,onClick:this.$MontageReplyLWR3,onMouseUp:this.$MontageReplyLWR4,onMouseDown:this.$MontageReplyLWR4,role:"button",tabIndex:m},this.state.animations[l]?c("React").createElement(c("DOMContainer.react"),null,this.state.animations[l]):c("React").createElement(c("MessengerTextWithEmoticons.react"),{customSize:true,renderEmoticons:true,renderEmoji:true,text:l}))}.bind(this)))};k.prototype.componentWillUnmount=function(){var l=this.$MontageReplyLWR5();if(l)this.props.sendReply(l,this.$MontageReplyLWR1)};k.prototype.$MontageReplyLWR2=function(){this.$MontageReplyLWR1=[];c("MontageReplyLWRUtil").defaultReactions.forEach(function(l){this.$MontageReplyLWR1.push({reaction:l,offsets:[]})}.bind(this))};k.prototype.loadAnimation=function(){c("Bootloader").loadModules(["bodymovin","MessengerReactionEmojiLove","MessengerReactionEmojiHaha","MessengerReactionEmojiWow","MessengerReactionEmojiSad","MessengerReactionEmojiAngry"],function(l){var m=c("MontageReplyLWRUtil").defaultReactions,n={};for(var o=arguments.length,p=Array(o>1?o-1:0),q=1;q<o;q++)p[q-1]=arguments[q];for(var r=0;r<m.length;r++){var s=m[r];n[s]=this.$MontageReplyLWR6(l,p[r])}this.setState({animations:n})}.bind(this),"MontageReplyLWR.react")};k.prototype.$MontageReplyLWR6=function(l,m){var n=c("DOM").create("span");l.loadAnimation({wrapper:n,animationData:m,renderer:"svg",loop:true,autoplay:true});return n};k.prototype.$MontageReplyLWR4=function(event){event.stopPropagation()};k.prototype.$MontageReplyLWR5=function(){var l="";for(var m=this.$MontageReplyLWR1.length-1;m>=0;m--)if(this.$MontageReplyLWR1[m].offsets.length>0)l+=this.$MontageReplyLWR1[m].reaction+" ";else this.$MontageReplyLWR1.splice(m,1);return l};f.exports=k}),null);
__d("MontageReplyContainer.react",["cx","CurrentUser","MercuryMessageActions","MercuryMessageObject","MercuryTriodeSourceUtil","MontageMessageReactionsWebGraphQLMutation","MontageReplyAction","MontageReplyComposer.react","MontageReplyLWR.react","React","XAsyncRequest"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;function k(){__p&&__p();var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.$MontageReplyContainer4=function(q,r){var s=this.$MontageReplyContainer2.constructUserGeneratedMessageObject(q,c("MercuryTriodeSourceUtil").getMercuryTriodeSource(),this.props.threadID);s.montage_reply_data={message_id:this.props.montageMessageID,reply_action:c("MontageReplyAction").MESSAGE_REACTION};this.$MontageReplyContainer1.send(s);if(r){var t=c("MontageMessageReactionsWebGraphQLMutation").getURI({actor_id:this.$MontageReplyContainer3,message_id:this.props.montageMessageID,actions:r});new(c("XAsyncRequest"))(t).setMethod("POST").send()}}.bind(this),m}k.prototype.componentWillMount=function(){this.$MontageReplyContainer3=c("CurrentUser").getID();this.$MontageReplyContainer1=c("MercuryMessageActions").getForFBID(this.$MontageReplyContainer3);this.$MontageReplyContainer2=c("MercuryMessageObject").getForFBID(this.$MontageReplyContainer3)};k.prototype.render=function(){return c("React").createElement("div",{className:"_2x5j"},c("React").createElement(c("MontageReplyComposer.react"),null),c("React").createElement(c("MontageReplyLWR.react"),{sendReply:this.$MontageReplyContainer4,startedTime:this.props.startedTime}))};f.exports=k}),null);
__d("XRapidReportingMessageDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/rapid_report/message/",{message_id:{type:"String",required:true},story_location:{type:"String",required:true}})}),null);
__d("MontageCard.react",["cx","fbt","AsyncRequest","CssBackgroundImage.react","CurrentUser","MercuryConfig","MercuryIDs","MessengerMenu.react","MontageProgressBar.react","MontageReplyContainer.react","MessengerPopoverMenu.react","Link.react","NFXStoryLocation","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","Timestamp.react","XRapidReportingMessageDialogController","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("MessengerMenu.react").Item,m=c("React").PropTypes,n=function n(p){return p.stopPropagation()};j=babelHelpers.inherits(o,c("React").Component);k=j&&j.prototype;function o(){__p&&__p();var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=k.constructor).call.apply(p,[this].concat(s)),this.state={progressPercent:0,startedTime:Date.now()},this.$MontageCard5=function(){var u,v=(u=this.props)!=null?(u=u.message)!=null?u.message_id:u:u;if(v){var w=c("XRapidReportingMessageDialogController").getURIBuilder().setString("message_id",v).setString("story_location",c("NFXStoryLocation").MESSENGER_MONTAGE_VIEWER).getURI(),x=new(c("AsyncRequest"))().setURI(w);x.send()}}.bind(this),this.$MontageCard1=function(u){if(u!==this.state.progressPercent)this.setState({progressPercent:u})}.bind(this),this.$MontageCard2=function(u){this.setState({startedTime:u})}.bind(this),q}o.prototype.render=function(){var p=this.props,q=p.active,r=p.activeIndex,s=p.count,t=p.message;if(!t)return null;var u=t.message_sender.messaging_actor,v=t.timestamp,w=c("React").Children.map(this.props.children,function(x){return c("React").cloneElement(x,{onProgress:this.$MontageCard1,onStarted:this.$MontageCard2})}.bind(this));return c("React").createElement("div",{className:"_5uag _q38",style:{zIndex:q?1:undefined}},c("React").createElement("div",{className:"_3avs"},w),c("React").createElement("div",{className:"_5uag _1pwf"},c("React").createElement(c("MontageProgressBar.react"),{activeIndex:r,count:s,progressPercent:this.state.progressPercent}),c("React").createElement("div",{className:"_1pwg"},c("React").createElement(c("CssBackgroundImage.react"),{className:"_3cx4",imageURI:u.profile_picture.uri}),c("React").createElement("div",{className:"_1pwn"},c("React").createElement("span",null,u.name),c("React").createElement(c("Timestamp.react"),{className:"_yc_",minimize:true,time:v})),this.$MontageCard3(),c("React").createElement(c("MessengerPopoverMenu.react"),{className:"_47gp",menu:this.$MontageCard4()},c("React").createElement(c("Link.react"),{"aria-haspopup":"true","aria-label":i._("Message Options"),className:"_47gq",onMouseUp:n,onMouseDown:n,role:"button"})))))};o.prototype.$MontageCard4=function(){var p=c("React").createElement(c("MessengerMenu.react"),null,c("React").createElement(l,{label:i._("Report"),onclick:this.$MontageCard5}));return p};o.prototype.$MontageCard3=function(){var p,q=this.props.message?this.props.message.message_id:"",r=c("CurrentUser").getID(),s=(p=this.props.message)!=null?(p=p.message_sender)!=null?p.id:p:p;s=s?s:null;if(c("MercuryConfig").WWWMessengerMontageLWR&&s&&s!==r)return c("React").createElement(c("MontageReplyContainer.react"),{montageMessageID:q,threadFBID:s,threadID:c("MercuryIDs").getThreadIDFromUserID(s),startedTime:this.state.startedTime});else return null};o.propTypes={active:m.bool.isRequired,activeIndex:m.number.isRequired,count:m.number.isRequired,message:m.object,children:m.object};f.exports=c("RelayClassic_DEPRECATED").createContainer(o,{fragments:{message:function p(){return function(){return{children:[{fieldName:"message_id",kind:"Field",metadata:{},type:"ID"},{children:[{fieldName:"message_source",kind:"Field",metadata:{},type:"String"}],fieldName:"message_source_data",kind:"Field",metadata:{canHaveSubselections:true},type:"MessageSourceData"},{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:true},type:"ID"},{children:[{fieldName:"name",kind:"Field",metadata:{},type:"String"},{calls:[{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallValue",callValue:50}},{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallValue",callValue:50}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"profile_picture",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],fieldName:"messaging_actor",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true},type:"MessagingActor"}],fieldName:"message_sender",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"MessagingParticipant"},{fieldName:"timestamp",kind:"Field",metadata:{},type:"Time"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageCard_react_MessageRelayQL",type:"UserMessage"}}()}}})}),null);
__d("montageCardWithStandardTimer",["React","cancelAnimationFrame","requestAnimationFrame"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("React").PropTypes,i=5e3;function j(k){__p&&__p();var l,m;return m=l=function(){__p&&__p();var n,o;n=babelHelpers.inherits(p,c("React").Component);o=n&&n.prototype;function p(){__p&&__p();var q,r;"use strict";for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=o.constructor).call.apply(q,[this].concat(t)),this.state={startedTime:0,pausedTime:0},this.$_class1=null,this.$_class3=function(){if(!this.props.paused){var v=(Date.now()-this.state.startedTime)/i*100;this.props.onProgress(v);if(v>=100){this.props.onEnded();return}}this.$_class1=c("requestAnimationFrame")(this.$_class3)}.bind(this),r}p.prototype.componentDidMount=function(){"use strict";this.$_class2()};p.prototype.componentDidUpdate=function(){"use strict";this.$_class2()};p.prototype.$_class2=function(){"use strict";if(!this.props.active&&(this.$_class1||this.state.pausedTime))this.$_class4();else if(!this.props.paused&&!this.$_class1)this.$_class5();else if(this.$_class1&&this.props.paused)this.$_class6()};p.prototype.$_class6=function(){"use strict";this.setState({pausedTime:Date.now()});c("cancelAnimationFrame")(this.$_class1);this.$_class1=null};p.prototype.$_class5=function(){"use strict";var q={startedTime:Date.now()};if(this.state.pausedTime){var r=q.startedTime-this.state.pausedTime,s=this.state.startedTime+r;q={pausedTime:0,startedTime:s}}this.setState(q);this.props.onStarted(q.startedTime);this.$_class1=c("requestAnimationFrame")(this.$_class3)};p.prototype.$_class4=function(){"use strict";this.setState({pausedTime:0,startedTime:0});c("cancelAnimationFrame")(this.$_class1);this.$_class1=null};p.prototype.componentWillUnmount=function(){"use strict";c("cancelAnimationFrame")(this.$_class1)};p.prototype.render=function(){"use strict";var q=this.props,r=q.paused,s=q.onEnded,t=q.onProgress,u=q.onStarted,v=babelHelpers.objectWithoutProperties(q,["paused","onEnded","onProgress","onStarted"]);return c("React").createElement(k,v)};return p}(),l.propTypes={active:h.bool.isRequired,paused:h.bool.isRequired,onEnded:h.func.isRequired,onProgress:h.func.isRequired,onStarted:h.func.isRequired},m}f.exports=j}),null);
__d("MontageCardPhoto.react",["cx","CssBackgroundImage.react","Image.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","montageCardWithStandardTimer"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",{className:"_5uag _3p9v"},c("React").createElement(c("Image.react"),{className:"_3p9w",src:this.props.photoAttachment.image.uri}))};function l(){i.apply(this,arguments)}l.propTypes={photoAttachment:k.shape({image:k.shape({uri:k.string.isRequired}).isRequired}).isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(c("montageCardWithStandardTimer")(l),{fragments:{photoAttachment:function m(){return function(){return{children:[{children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageCardPhoto_react_PhotoAttachmentRelayQL",type:"MessageImage"}}()}}})}),null);
__d("MontageCardSticker.react",["cx","Image.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","montageCardWithStandardTimer"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){var m=this.props.sticker.animated_image?this.props.sticker.animated_image.uri:this.props.sticker.image.uri;return c("React").createElement("div",{className:"_5uag _3p9v"},c("React").createElement(c("Image.react"),{src:m}))};function l(){i.apply(this,arguments)}l.propTypes={sticker:k.shape({animated_image:k.shape({uri:k.string.isRequired}),image:k.shape({uri:k.string.isRequired})}).isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(c("montageCardWithStandardTimer")(l),{fragments:{sticker:function m(){return function(){return{children:[{children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"animated_image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageCardSticker_react_StickerRelayQL",type:"Sticker"}}()}}})}),null);
__d("MontageCardText.react",["cx","MessengerTextWithEntities.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","montageCardWithStandardTimer"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement(c("MessengerTextWithEntities.react"),{className:"_5uag _2zz1",customSize:true,renderEmoji:true,text:this.props.userMessage.message.text})};function l(){i.apply(this,arguments)}l.propTypes={userMessage:k.shape({message:k.shape({text:k.string.isRequired}).isRequired}).isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(c("montageCardWithStandardTimer")(l),{fragments:{userMessage:function m(){return function(){return{children:[{children:[{fieldName:"text",kind:"Field",metadata:{},type:"String"}],fieldName:"message",kind:"Field",metadata:{canHaveSubselections:true},type:"TextWithEntities"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageCardText_react_UserMessageRelayQL",type:"UserMessage"}}()}}})}),null);
__d("MontageCardVideo.react",["cx","Video.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","cancelAnimationFrame","requestAnimationFrame"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$MontageCardVideo1=null,this.$MontageCardVideo5=function(){if(this.$MontageCardVideo2&&this.$MontageCardVideo2.readyState>0){var r=this.$MontageCardVideo2.currentTime/this.$MontageCardVideo2.duration*100;this.props.onProgress(r);if(r>=100){this.props.onEnded();return}}this.$MontageCardVideo1=c("requestAnimationFrame")(this.$MontageCardVideo5)}.bind(this),n}l.prototype.componentDidMount=function(){this.$MontageCardVideo3()};l.prototype.componentDidUpdate=function(){this.$MontageCardVideo3()};l.prototype.componentWillUnmount=function(){this.$MontageCardVideo4()};l.prototype.$MontageCardVideo3=function(){__p&&__p();if(!this.$MontageCardVideo2)return;if(!this.props.paused&&this.$MontageCardVideo2.paused){this.$MontageCardVideo2.play();this.$MontageCardVideo1=c("requestAnimationFrame")(this.$MontageCardVideo5)}else{this.$MontageCardVideo4();if(!this.props.active&&this.$MontageCardVideo2)this.$MontageCardVideo2.currentTime=0}};l.prototype.$MontageCardVideo4=function(){c("cancelAnimationFrame")(this.$MontageCardVideo1);this.$MontageCardVideo1=null;if(this.$MontageCardVideo2)this.$MontageCardVideo2.pause()};l.prototype.render=function(){return c("React").createElement(c("Video.react"),{autoPlay:false,className:"_5uag",onEnded:this.props.onEnded,onError:this.props.onEnded,src:this.props.videoAttachment.playable_url,ref:function(m){return this.$MontageCardVideo2=m&&m.refs.video}.bind(this)})};l.propTypes={paused:k.bool.isRequired,onEnded:k.func.isRequired,onProgress:k.func.isRequired,videoAttachment:k.shape({playable_url:k.string.isRequired}).isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(l,{fragments:{videoAttachment:function m(){return function(){return{children:[{fieldName:"playable_url",kind:"Field",metadata:{},type:"Url"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageCardVideo_react_VideoAttachmentRelayQL",type:"MessageVideo"}}()}}})}),null);
__d("MontageShouldUpdateReducer",["MontageActions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MontageActions").Types;function i(k,l){var m;switch(l.type){case h.REQUEST_UPDATE:var n=babelHelpers["extends"]({},k.needsUpdating,(m={},m[l.threadFBID]=true,m));return babelHelpers["extends"]({},k,{needsUpdating:n})}return k}function j(k,l){switch(l.type){case h.HAS_UPDATED:var m=k.needsUpdating,n=m[l.threadFBID],o=babelHelpers.objectWithoutProperties(m,[l.threadFBID]);return babelHelpers["extends"]({},k,{needsUpdating:o})}return k}f.exports={requestUpdate:i,hasUpdated:j}}),null);
__d("MessengerMobileWindow.react",["cx","MessengerPhotoViewCloseLink.react","React","SpotlightViewer"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){var m=this.props,n=m.background,o=m.fontSize,p=m.onHide,q=m.open,r=m.children,s=m.onClose,t=babelHelpers.objectWithoutProperties(m,["background","fontSize","onHide","open","children","onClose"]);return c("React").createElement(c("SpotlightViewer"),{onHide:p,open:q,rootClassName:"_7yx"+(n==="light"?" _1lwq":"")},c("React").createElement("div",babelHelpers["extends"]({className:"_7yy"},t),c("React").createElement("div",{className:"_7yz"}),c("React").createElement("div",{className:(this.props.orientation==="landscape"?"_pxe":"")+(this.props.orientation==="portrait"?" _pxf":"")+" _7y-"+(o==="auto"?" _5q__":"")},c("React").createElement("div",{className:"_5uag"},r)),c("React").createElement(c("MessengerPhotoViewCloseLink.react"),{onClick:s,customTooltip:null})))};function l(){i.apply(this,arguments)}l.defaultProps={background:"light",fontSize:"auto",orientation:"portrait"};l.propTypes={background:k.string.isRequired,fontSize:k.string.isRequired,onClose:k.func.isRequired,onHide:k.func.isRequired,open:k.bool.isRequired};f.exports=l}),null);
__d("MontageSpotlightViewer.react",["KeyEventController","MessengerMobileWindow.react","MessengerMontageClientTypedLogger","MontageCard.react","MontageCardPhoto.react","MontageCardSticker.react","MontageCardText.react","MontageCardVideo.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","SubscriptionsHandler"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes,k=300,l={auto_play:"auto_play",click:"click",arrow:"arrow",esc:"esc",click_exit_button:"click_exit_button"},m={next:"_next",prev:"_prev"},n=function n(event,q){if(q=="onkeyup")return c("KeyEventController").filterEventTargets(event,q)&&c("KeyEventController").filterEventModifiers(event,q);return false};h=babelHelpers.inherits(o,c("React").Component);i=h&&h.prototype;function o(){__p&&__p();var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=i.constructor).call.apply(q,[this].concat(t)),this.state=this.initialState(),this.$MontageSpotlightViewer1=new(c("SubscriptionsHandler"))(),this.$MontageSpotlightViewer2="unknown",this.$MontageSpotlightViewer3=null,this.$MontageSpotlightViewer6=function(){this.setState({paused:Date.now()})}.bind(this),this.$MontageSpotlightViewer7=function(){var v=Date.now()-this.state.paused;if(v<k)this.$MontageSpotlightViewer5(l.click);else this.setState({paused:0})}.bind(this),this.$MontageSpotlightViewer9=function(){this.setState({cardIndex:0,paused:0,open:false})}.bind(this),this.$MontageSpotlightViewer12=this.$MontageSpotlightViewer5.bind(this,l.auto_play),this.$MontageSpotlightViewer8=function(){this.$MontageSpotlightViewer3=Date.now()}.bind(this),r}o.prototype.initialState=function(){var q=this.props.messages?this.props.messages.count:1;return{cardIndex:this.props.initialUnreadCount?q-this.props.initialUnreadCount:0,open:true,paused:0}};o.prototype.componentDidMount=function(){__p&&__p();this.$MontageSpotlightViewer1.addSubscriptions(c("KeyEventController").registerKey("LEFT",function(){this.$MontageSpotlightViewer4(l.arrow);return false}.bind(this)),c("KeyEventController").registerKey("RIGHT",function(){this.$MontageSpotlightViewer5(l.arrow);return false}.bind(this)),c("KeyEventController").registerKey("SPACE",function(){if(!this.state.paused)this.$MontageSpotlightViewer6();return false}.bind(this)),c("KeyEventController").registerKey("SPACE",function(){this.$MontageSpotlightViewer7();return false}.bind(this),n));this.$MontageSpotlightViewer8()};o.prototype.render=function(){return c("React").createElement(c("MessengerMobileWindow.react"),{onClose:this.$MontageSpotlightViewer9,onHide:this.props.onHide,onMouseDown:this.$MontageSpotlightViewer6,onMouseUp:this.$MontageSpotlightViewer7,open:this.state.open},this.$MontageSpotlightViewer10())};o.prototype.componentWillUnmount=function(){this.$MontageSpotlightViewer1&&this.$MontageSpotlightViewer1.release();this.$MontageSpotlightViewer1=null};o.prototype.$MontageSpotlightViewer10=function(){__p&&__p();var q=this.props.messages||{edges:[{node:this.props.message}]};return q.edges.map(function(r,s){__p&&__p();var t=r.node;if(!t||s<this.state.cardIndex-3||s>this.state.cardIndex+3)return null;var u=t.blob_attachments[0],v=t.sticker,w=this.props.messages?this.props.messages.count:1,x=s===this.state.cardIndex,y=!(x&&!this.state.paused),z=null,A=u&&u.__typename;if(A==="MessageImage"){x&&this.$MontageSpotlightViewer11("photo");z=c("React").createElement(c("MontageCardPhoto.react"),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,photoAttachment:u})}else if(A==="MessageVideo"){x&&this.$MontageSpotlightViewer11("video");z=c("React").createElement(c("MontageCardVideo.react"),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,videoAttachment:u})}else if(v){x&&this.$MontageSpotlightViewer11("sticker");z=c("React").createElement(c("MontageCardSticker.react"),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,sticker:v})}else{x&&this.$MontageSpotlightViewer11("text");z=c("React").createElement(c("MontageCardText.react"),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,userMessage:t})}return z?c("React").createElement(c("MontageCard.react"),{active:x,activeIndex:this.state.cardIndex,count:w,key:t.message_id,message:t},z):null}.bind(this)).filter(Boolean)};o.prototype.$MontageSpotlightViewer11=function(q){this.$MontageSpotlightViewer2=q};o.prototype.$MontageSpotlightViewer4=function(q){this.logMessageExit(q+m.prev);var r=this.state.cardIndex-1;if(r<0){this.$MontageSpotlightViewer9();return}this.setState({cardIndex:r,paused:0},this.$MontageSpotlightViewer8)};o.prototype.$MontageSpotlightViewer5=function(q){this.logMessageExit(q+m.next);var r=this.props.messages?this.props.messages.count:1,s=this.state.cardIndex+1;if(s>=r){this.$MontageSpotlightViewer9();return}this.props.loadMore(1);this.setState({cardIndex:s,paused:0},this.$MontageSpotlightViewer8)};o.prototype.logMessageExit=function(q){__p&&__p();var r=Date.now(),s=this.props.messages?this.props.messages.count:1,t=this.props.initialUnreadCount||s,u=this.state.cardIndex-(s-t)+1,v=this.props.initialUnreadCount?"unseen":"seen",w=void 0;if(this.props.messages){var x=this.props.messages.edges[this.state.cardIndex];w=x&&x.node}else w=this.props.message;if(!w||!this.$MontageSpotlightViewer3)return;var y=r-this.$MontageSpotlightViewer3;new(c("MessengerMontageClientTypedLogger"))().setEvent("message_exit").setMid(w.message_id).setOwnerID(w.message_sender.id).setMessageSource(w.message_source_data&&w.message_source_data.message_source).setExitAction(q).setContentType(this.$MontageSpotlightViewer2).setTotalQueue(t).setQueueType(v).setCurrentPosition(u).setEntryPoint(this.props.entryPoint).setMessageStartTime(this.$MontageSpotlightViewer3).setMessageDuration(y).log()};o.propTypes={entryPoint:j.oneOf(["thread_head","reply_context"]),initialUnreadCount:j.number,onHide:j.func.isRequired,loadMore:j.func.isRequired,message:j.object,messages:j.object,relay:j.object.isRequired};var p=function(q,r,s,t,u){return{children:[].concat.apply([],[{fieldName:"message_id",kind:"Field",metadata:{},type:"ID"},{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:true},type:"ID"}],fieldName:"message_sender",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"MessagingParticipant"},{children:[{fieldName:"message_source",kind:"Field",metadata:{},type:"String"}],fieldName:"message_source_data",kind:"Field",metadata:{canHaveSubselections:true},type:"MessageSourceData"},{children:[].concat.apply([],[{fieldName:"__typename",kind:"Field",metadata:{isRequisite:true},type:"String"},c("react-relay/classic/query/RelayQL").__frag(s),c("react-relay/classic/query/RelayQL").__frag(t),{children:[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"IdFragment",type:"Node"}]),fieldName:"blob_attachments",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true,isPlural:true},type:"MessageBlobAttachment"},{children:[].concat.apply([],[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},c("react-relay/classic/query/RelayQL").__frag(u)]),fieldName:"sticker",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"Sticker"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},c("react-relay/classic/query/RelayQL").__frag(q),c("react-relay/classic/query/RelayQL").__frag(r)]),id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageSpotlightViewer_reactRelayQL",type:"UserMessage"}}(c("MontageCard.react").getFragment("message"),c("MontageCardText.react").getFragment("userMessage"),c("MontageCardPhoto.react").getFragment("photoAttachment"),c("MontageCardVideo.react").getFragment("videoAttachment"),c("MontageCardSticker.react").getFragment("sticker"));f.exports=c("RelayClassic_DEPRECATED").createContainer(o,{fragments:{messages:function q(){return function(r){return{children:[{fieldName:"count",kind:"Field",metadata:{},type:"Int"},{children:[{children:[].concat.apply([],[{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"},c("react-relay/classic/query/RelayQL").__frag(r),{children:[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"IdFragment",type:"Node"}]),fieldName:"node",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true,isRequisite:true},type:"Message"},{fieldName:"cursor",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],fieldName:"edges",kind:"Field",metadata:{canHaveSubselections:true,isPlural:true},type:"MessagesOfThreadEdge"},{children:[{fieldName:"has_next_page",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"Boolean"},{fieldName:"has_previous_page",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"Boolean"}],fieldName:"page_info",kind:"Field",metadata:{canHaveSubselections:true,isGenerated:true,isRequisite:true},type:"PageInfo"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageSpotlightViewer_react_MessagesRelayQL",type:"MessagesOfThreadConnection"}}(p)},message:function q(){return p}}})}),null);
__d("MontageState",[],(function a(b,c,d,e,f,g){"use strict";var h={needsUpdating:{}};f.exports=h}),null);
__d("MontageStore",["MontageDispatcher","MontageShouldUpdateReducer","MontageState","FluxReduceStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=[].concat(Object.values(c("MontageShouldUpdateReducer")));h=babelHelpers.inherits(k,c("FluxReduceStore"));i=h&&h.prototype;k.prototype.getInitialState=function(){return c("MontageState")};k.prototype.reduce=function(l,m){return j.reduce(function(l,n){return n(l,m)},l)};function k(){h.apply(this,arguments)}f.exports=new k(c("MontageDispatcher"))}),null);
__d("MessengerMarkReadMutation",["react-relay/classic/mutation/RelayMutation","react-relay/classic/query/RelayQL"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("react-relay/classic/mutation/RelayMutation"));i=h&&h.prototype;j.prototype.getMutation=function(){return function(){return{calls:[{kind:"Call",metadata:{},name:"message_thread_update_read_state",value:{kind:"CallVariable",callVariableName:"input"}}],children:[{fieldName:"client_mutation_id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],kind:"Mutation",metadata:{inputType:"MessageThreadUpdateReadStateData!"},name:"MessengerMarkReadMutation",responseType:"MessageThreadUpdateReadStateResponsePayload"}}()};j.prototype.getVariables=function(){return{actor_id:this.props.actorID,thread_id:this.props.threadID,update_type:"mark_read"}};j.prototype.getFatQuery=function(){return function(){return{children:[{children:[{fieldName:"unread_count",kind:"Field",metadata:{},type:"Int"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],fieldName:"thread",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"MessageThread"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessengerMarkReadMutationRelayQL",type:"MessageThreadUpdateReadStateResponsePayload"}}()};j.prototype.getConfigs=function(){return[{type:"FIELDS_CHANGE",fieldIDs:{thread:this.props.threadID}}]};j.prototype.getOptimisticResponse=function(){return{thread:{id:this.props.threadID,unread_count:0}}};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("MontageThumbnail.react",["cx","CssBackgroundImage.react","MessengerTextWithEntities.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l=28,m=21;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;n.prototype.render=function(){return c("React").createElement("div",{className:"_4bj3"},this.getFirstImage(),this.renderUnreadBadge())};n.prototype.renderUnreadBadge=function(){return this.props.unread?c("React").createElement("div",{className:"_4bj5",style:{backgroundColor:this.props.customColor}}):null};n.prototype.getFirstImage=function(){__p&&__p();var o=this.props.message;if(!o)return null;if(o.sticker)return this.getImageElement(o.sticker.image);if(o.blob_attachments[0]){var p=o.blob_attachments[0],q=p.image||p.videoImage||p.mediaImage;if(q)return this.getImageElement(q)}if(o.message.text)return c("React").createElement(c("MessengerTextWithEntities.react"),{className:"_4bj6 _4bj9",customSize:true,renderEmoji:true,style:{height:this.props.imageHeight,width:this.props.imageWidth},text:o.message.text});return null};n.prototype.getImageElement=function(o){return c("React").createElement(c("CssBackgroundImage.react"),{className:"_4bj6",height:this.props.imageHeight,imageURI:o.uri,width:this.props.imageWidth})};function n(){i.apply(this,arguments)}n.propTypes={customColor:k.string,message:k.object.isRequired,unread:k.bool.isRequired,imageHeight:k.number.isRequired,imageWidth:k.number.isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(n,{initialVariables:{imageHeight:l,imageWidth:m},fragments:{message:function o(p){return function(){return{children:[{children:[{fieldName:"text",kind:"Field",metadata:{},type:"String"}],fieldName:"message",kind:"Field",metadata:{canHaveSubselections:true},type:"TextWithEntities"},{children:[{calls:[{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallVariable",callVariableName:"imageHeight"}},{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallVariable",callVariableName:"imageWidth"}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],fieldName:"sticker",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"Sticker"},{children:[{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"},{children:[{alias:"mediaImage",calls:[{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallVariable",callVariableName:"imageHeight"}},{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallVariable",callVariableName:"imageWidth"}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"},{children:[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"IdFragment",type:"Node"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"Media",type:"Media"},{children:[{alias:"videoImage",calls:[{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallVariable",callVariableName:"imageHeight"}},{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallVariable",callVariableName:"imageWidth"}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessageVideo",type:"MessageVideo"},{children:[{calls:[{kind:"Call",metadata:{type:"Int"},name:"height",value:{kind:"CallVariable",callVariableName:"imageHeight"}},{kind:"Call",metadata:{type:"Int"},name:"width",value:{kind:"CallVariable",callVariableName:"imageWidth"}}],children:[{fieldName:"uri",kind:"Field",metadata:{},type:"Url"}],fieldName:"image",kind:"Field",metadata:{canHaveSubselections:true},type:"Image"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessageImage",type:"MessageImage"},{children:[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"IdFragment",type:"Node"}],fieldName:"blob_attachments",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true,isPlural:true},type:"MessageBlobAttachment"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageThumbnail_react_MessageRelayQL",type:"UserMessage"}}()}}})}),null);
__d("MontageViewerSingleThread.react",["MontageSpotlightViewer.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes;h=babelHelpers.inherits(k,c("React").Component);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$MontageViewerSingleThread1=function(q){var r=this.props.montageThread.messages.count,s=this.props.relay.variables.count;if(s<r){var t=Math.min(s+q,r);this.props.relay.setVariables({count:t})}}.bind(this),m}k.prototype.render=function(){return this.props.open?c("React").createElement(c("MontageSpotlightViewer.react"),{entryPoint:"reply_context",initialUnreadCount:this.props.unreadCount,loadMore:this.$MontageViewerSingleThread1,onHide:this.props.onHide,messages:this.props.montageThread.messages}):null};k.propTypes={open:j.bool.isRequired,onHide:j.func.isRequired,montageThread:j.object.isRequired,relay:j.object.isRequired,unreadCount:j.number.isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(k,{initialVariables:{count:100},fragments:{montageThread:function l(){return function(m){return{children:[{calls:[{kind:"Call",metadata:{type:"Int"},name:"last",value:{kind:"CallVariable",callVariableName:"count"}}],children:[].concat.apply([],[c("react-relay/classic/query/RelayQL").__frag(m)]),fieldName:"messages",kind:"Field",metadata:{canHaveSubselections:true,isConnection:true},type:"MessagesOfThreadConnection"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageViewerSingleThread_react_MontageThreadRelayQL",type:"MessageThread"}}(c("MontageSpotlightViewer.react").getFragment("messages"))}}})}),null);
__d("MontageThreadView.react",["cssVar","cx","fbt","CurrentUser","MessengerEnvironment","MessengerLogo.react","MessengerMarkReadMutation","MontageThumbnail.react","MontageViewerSingleThread.react","React","RelayClassic_DEPRECATED","react-relay/classic/query/RelayQL","Timestamp.react","convertMIGColorToFIGColor","gkx","idx"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=28,n=21,o=c("React").PropTypes;k=babelHelpers.inherits(p,c("React").PureComponent);l=k&&k.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=l.constructor).call.apply(q,[this].concat(t)),this.state={showMontage:false},this.$MontageThreadView1=function(){this.setState({showMontage:true})}.bind(this),this.$MontageThreadView2=function(){this.setState({showMontage:false});this.props.relay.commitUpdate(new(c("MessengerMarkReadMutation"))({threadID:this.props.threadMessages.montage_thread.id,actorID:c("CurrentUser").getID()}))}.bind(this),r}p.prototype.componentDidMount=function(){if(this.props.threadMessages)this.props.onResize&&this.props.onResize();var q=this.getMontageThreadID();if(q)this.props.setThreadID&&this.props.setThreadID(q)};p.prototype.componentDidUpdate=function(q){if(q.threadMessages!==this.props.threadMessages)this.props.onResize&&this.props.onResize()};p.prototype.render=function(){var q=this.getFirstMontageMessage();if(!q)return null;var r=this.getCustomColor(),s=this.getUnread();return c("React").createElement("a",{className:"_5no5",href:"#",onClick:this.$MontageThreadView1,role:"button"},c("React").createElement(c("MontageThumbnail.react"),{customColor:r,message:q,unread:s,imageHeight:m,imageWidth:n}),c("React").createElement("div",{className:"_1sui"},this.renderHeader(s,r),c("React").createElement("span",{className:"_1suk"},c("React").createElement(c("Timestamp.react"),{minimize:true,time:this.getTimestamp()}))),this.renderLogo(),this.renderModal())};p.prototype.renderModal=function(){return this.state.showMontage?c("React").createElement(c("MontageViewerSingleThread.react"),{onHide:this.$MontageThreadView2,open:this.state.showMontage,montageThread:this.props.threadMessages.montage_thread,unreadCount:this.props.threadMessages.montage_thread.unread_count}):null};p.prototype.renderLogo=function(){return c("MessengerEnvironment").messengerui?null:c("React").createElement(c("MessengerLogo.react"),{color:"rgba(0, 0, 0, .3)",size:"17px"})};p.prototype.renderHeader=function(q,r){if(q){if(c("gkx")("AT5XstoxIytYg6rcTtwy7QhvULoTix8ykmL9foPyj3EokHfd_brNYpQZNE9-HAHuHEZUql4rz03HzTx9pm3SACcTAchn7Q_p0XTMaw17pwmv6w"))return c("React").createElement("h1",{className:"_1suj",style:{color:r}},j._("Watch {person_with_montage}'s story",[j.param("person_with_montage",this.getAuthorName())]));return c("React").createElement("h1",{className:"_1suj",style:{color:r}},j._("Watch {person_with_montage}'s day",[j.param("person_with_montage",this.getAuthorName())]))}return null};p.prototype.getAuthorName=function(){var q;return(q=this.props)!=null?(q=q.threadMessages)!=null?(q=q.montage_thread)!=null?(q=q.montage_author)!=null?q.short_name:q:q:q:q};p.prototype.getFirstMontageMessage=function(){var q;return(q=this.props)!=null?(q=q.threadMessages)!=null?(q=q.montage_thread)!=null?(q=q.messages)!=null?(q=q.edges)!=null?(q=q[0])!=null?q.node:q:q:q:q:q:q};p.prototype.getTimestamp=function(){var q=this.getFirstMontageMessage();return q&&q.timestamp};p.prototype.getCustomColor=function(){var q,r=(q=this.props)!=null?(q=q.threadMessages)!=null?(q=q.customization_info)!=null?q.outgoing_bubble_color:q:q:q,s=void 0;if(!r)s="#0084ff";else s="#"+r.substring(2);return c("convertMIGColorToFIGColor")(s)};p.prototype.getUnread=function(){var q;return!!((q=this.props)!=null?(q=q.threadMessages)!=null?(q=q.montage_thread)!=null?q.unread_count:q:q:q)};p.prototype.getMontageThreadID=function(){var q;return(q=this.props)!=null?(q=q.threadMessages)!=null?(q=q.montage_thread)!=null?(q=q.thread_key)!=null?q.thread_fbid:q:q:q:q};p.propTypes={onResize:o.func,threadMessages:o.object.isRequired};f.exports=c("RelayClassic_DEPRECATED").createContainer(p,{fragments:{threadMessages:function q(r){return function(s,t){return{children:[{children:[{fieldName:"outgoing_bubble_color",kind:"Field",metadata:{},type:"Color"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],fieldName:"customization_info",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"MessageThreadCustomization"},{children:[].concat.apply([],[{fieldName:"id",kind:"Field",metadata:{isRequisite:true},type:"ID"},{children:[{fieldName:"thread_fbid",kind:"Field",metadata:{},type:"String"}],fieldName:"thread_key",kind:"Field",metadata:{canHaveSubselections:true},type:"MessageThreadKey"},{calls:[{kind:"Call",metadata:{type:"Int"},name:"last",value:{kind:"CallValue",callValue:1}}],children:[{children:[{children:[].concat.apply([],[{fieldName:"timestamp",kind:"Field",metadata:{},type:"Time"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"},c("react-relay/classic/query/RelayQL").__frag(t),{children:[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:true},name:"IdFragment",type:"Node"}]),fieldName:"node",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true,isRequisite:true},type:"Message"},{fieldName:"cursor",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],fieldName:"edges",kind:"Field",metadata:{canHaveSubselections:true,isPlural:true},type:"MessagesOfThreadEdge"},{children:[{fieldName:"has_next_page",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"Boolean"},{fieldName:"has_previous_page",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"Boolean"}],fieldName:"page_info",kind:"Field",metadata:{canHaveSubselections:true,isGenerated:true,isRequisite:true},type:"PageInfo"}],fieldName:"messages",kind:"Field",metadata:{canHaveSubselections:true,isConnection:true},type:"MessagesOfThreadConnection"},{children:[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"String"},{children:[{fieldName:"short_name",kind:"Field",metadata:{},type:"String"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"User",type:"User"}],fieldName:"montage_author",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:true},type:"Actor"},{fieldName:"unread_count",kind:"Field",metadata:{},type:"Int"},c("react-relay/classic/query/RelayQL").__frag(s)]),fieldName:"montage_thread",kind:"Field",metadata:{canHaveSubselections:true,inferredRootCallName:"node",inferredPrimaryKey:"id"},type:"MessageThread"},{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"}],id:c("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MontageThreadView_react_ThreadMessagesRelayQL",type:"MessageThread"}}(c("MontageViewerSingleThread.react").getFragment("montageThread"),c("MontageThumbnail.react").getFragment("message",{imageHeight:m,imageWidth:n}))}}})}),null);
__d("MontageThreadViewRoute",["react-relay/classic/query/RelayQL","react-relay/classic/route/RelayRoute"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("react-relay/classic/route/RelayRoute"));i=h&&h.prototype;function j(){h.apply(this,arguments)}j.routeName="MontageThreadViewRoute";j.queries={threadMessages:function k(l){return function(m){return{calls:[{kind:"Call",metadata:{type:"ID!"},name:"id",value:{kind:"CallVariable",callVariableName:"threadFBID"}}],children:[].concat.apply([],[{fieldName:"id",kind:"Field",metadata:{isGenerated:true,isRequisite:true},type:"ID"},c("react-relay/classic/query/RelayQL").__frag(m)]),fieldName:"message_thread",kind:"Query",metadata:{identifyingArgName:"id",identifyingArgType:"ID!"},name:"MontageThreadViewRoute",type:"MessageThread"}}(l.getFragment("threadMessages"))}};j.paramDefinitions={threadFBID:{type:"ID",required:true}};f.exports=j}),null);
__d("MontageThreadViewContainerImpl.react",["FluxContainer","MercuryIDs","MontageActions","MontageStore","MontageThreadView.react","MontageThreadViewRoute","React","RelayClassic_DEPRECATED"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("RelayClassic_DEPRECATED").RootContainer,k=c("React").PropTypes;h=babelHelpers.inherits(l,c("React").PureComponent);i=h&&h.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.threadIDToMontageThreadID={},this.$MontageThreadViewContainer1=function(r){var s=c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID);if(!s)return null;return c("React").createElement(c("MontageThreadView.react"),babelHelpers["extends"]({},r,{onResize:this.props.onResize,setThreadID:this.$MontageThreadViewContainer4}))}.bind(this),this.$MontageThreadViewContainer3=function(r){if(r&&r.stale)return;var s=c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID),t=this.threadIDToMontageThreadID[s];if(this.state.needsUpdating[s])c("MontageActions").hasUpdated(s);if(this.state.needsUpdating[s])c("MontageActions").hasUpdated(t)}.bind(this),this.$MontageThreadViewContainer4=function(r){var s=c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID);this.threadIDToMontageThreadID[s]=r}.bind(this),n}l.getStores=function(){return[c("MontageStore")]};l.calculateState=function(){return{needsUpdating:c("MontageStore").getState().needsUpdating}};l.prototype.render=function(){var m=this.props.threadID,n=c("MercuryIDs").getThreadFBIDFromThreadID(m);if(!n)return null;return c("React").createElement(j,{Component:c("MontageThreadView.react"),route:new(c("MontageThreadViewRoute"))({threadFBID:n}),renderFetched:this.$MontageThreadViewContainer1,forceFetch:this.$MontageThreadViewContainer2(n),onReadyStateChange:this.$MontageThreadViewContainer3})};l.prototype.$MontageThreadViewContainer2=function(m){return!!(this.state.needsUpdating[m]||this.state.needsUpdating[this.threadIDToMontageThreadID[m]])};l.propTypes={onResize:k.func,threadID:k.string.isRequired};f.exports=c("FluxContainer").create(l)}),null);